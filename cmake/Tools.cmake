FUNCTION(ADD_TARGET_GDR)
    CMAKE_PARSE_ARGUMENTS("ARG" "" "MODE;NAME" "SOURCES;LIBS_GENERAL;LIBS_DEBUG;LIBS_RELEASE" ${ARGN})

    MESSAGE(STATUS "--------------------------------------------------")

    MESSAGE(STATUS "- MODE: ${ARG_MODE}")
    MESSAGE(STATUS "- NAME: ${ARG_NAME}")
    MESSAGE(STATUS "- SOURCES:")
    FOREACH (SOURCES ${ARG_SOURCES})
        MESSAGE(STATUS "  - ${SOURCE}")
    ENDFOREACH ()
    MESSAGE(STATUS "- LIBRARIES:")
    MESSAGE(STATUS "  - GENERAL:")
    FOREACH (LIBRARIES ${ARG_LIBS_GENERAL})
        MESSAGE(STATUS "    - ${LIBRARY}")
    ENDFOREACH ()
    MESSAGE(STATUS "  - DEBUG:")
    FOREACH (LIBRARIES ${ARG_LIBS_DEBUG})
        MESSAGE(STATUS "    - ${LIBRARY}")
    ENDFOREACH ()
    MESSAGE(STATUS "  - RELEASE:")
    FOREACH (LIBRARIES ${ARG_LIBS_RELEASE})
        MESSAGE(STATUS "    - ${LIBRARY}")
    ENDFOREACH ()

    IF (SOURCE_NUM EQUAL 0)
        MESSAGE(WARNING "Target [${ARG_NAME}] has no source files.")
    ELSE ()
        SET(IS_SUPPORT ON)
        IF (${ARG_MODE} STREQUAL "EXE")
            ADD_EXECUTABLE(${ARG_NAME} ${ARG_SOURCES})
            IF (MSVC)
                SET_TARGET_PROPERTIES(${ARG_NAME} PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY "${CMAKE_SOURCE_DIR}/bin")
            ENDIF ()
            SET_TARGET_PROPERTIES(${ARG_NAME} PROPERTIES DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX})
        ELSEIF (${ARG_MODE} STREQUAL "LIB")
            ADD_LIBRARY(${ARG_NAME} ${ARG_SOURCES})
        ELSEIF (${ARG_MODE} STREQUAL "DLL")
            ADD_LIBRARY(${ARG_NAME} SHARED ${ARG_SOURCES})
        ELSE ()
            MESSAGE(FATAL_ERROR "Unsupported target mode: ${ARG_MODE}")
            SET(IS_SUPPORT OFF)
        ENDIF ()
        IF (IS_SUPPORT)
            IF (NOT ${FOLDER_NAME} STREQUAL " ")
                SET_TARGET_PROPERTIES(${ARG_NAME} PROPERTIES FOLDER ${FOLDER_NAME})
            ENDIF ()
            FOREACH (LIBRARY ${ARG_LIBS_GENERAL})
                TARGET_LINK_LIBRARIES(${ARG_NAME} GENERAL ${LIBRARY})
            ENDFOREACH ()
            FOREACH (LIBRARY ${ARG_LIBS_DEBUG})
                TARGET_LINK_LIBRARIES(${ARG_NAME} DEBUG ${LIBRARY})
            ENDFOREACH ()
            FOREACH (LIBRARY ${ARG_LIBS_RELEASE})
                TARGET_LINK_LIBRARIES(${ARG_NAME} OPTIMIZED ${LIBRARY})
            ENDFOREACH ()
            INSTALL(TARGETS ${ARG_NAME}
                    RUNTIME DESTINATION "bin"
                    LIBRARY DESTINATION "lib/${FOLDER_NAME}"
                    ARCHIVE DESTINATION "lib/${FOLDER_NAME}")
        ENDIF ()
    ENDIF ()

    MESSAGE(STATUS "--------------------------------------------------")
ENDFUNCTION()

FUNCTION(ADD_TARGET)
    CMAKE_PARSE_ARGUMENTS("ARG" "" "MODE;NAME" "SOURCES;LIBS" ${ARGN})
    ADD_TARGET_GDR(MODE ${ARG_MODE} NAME ${ARG_NAME} SOURCES ${ARG_SOURCES} LIBS_GENERAL ${ARG_LIBS} LIBS_DEBUG "" LIBS_RELEASE "")
ENDFUNCTION()

FUNCTION(ADD_SUB_DIRS)
    FILE(GLOB CHILDREN RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_SOURCE_DIR}/*)
    SET(DIRLIST "")
    FOREACH (CHILD ${CHILDREN})
        IF (IS_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/${CHILD})
            LIST(APPEND DIRLIST ${CHILD})
        ENDIF ()
    ENDFOREACH ()
    FOREACH (SUBDIR ${DIRLIST})
        ADD_SUBDIRECTORY(${SUBDIR})
    ENDFOREACH ()
ENDFUNCTION()

FUNCTION(GET_DIR_NAME DIRNAME)
    STRING(REGEX MATCH "([^/]*)$" TMP ${CMAKE_CURRENT_SOURCE_DIR})
    SET(${DIRNAME} ${TMP} PARENT_SCOPE)
ENDFUNCTION()

FUNCTION(QT_BEGIN)
    SET(CMAKE_AUTOMOC ON PARENT_SCOPE)
    set(CMAKE_AUTOUIC ON PARENT_SCOPE)
    set(CMAKE_AUTORCC ON PARENT_SCOPE)
ENDFUNCTION()

FUNCTION(QT_END)
    SET(CMAKE_AUTOMOC OFF PARENT_SCOPE)
    set(CMAKE_AUTOUIC OFF PARENT_SCOPE)
    set(CMAKE_AUTORCC OFF PARENT_SCOPE)
ENDFUNCTION()
